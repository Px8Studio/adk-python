# ============================================================================
# DNB API Tools - DEVELOPMENT Environment
# ============================================================================

sources:
  dnb-api-dev:
    kind: http
    baseUrl: https://api.dnb.nl
    timeout: 30s
    headers:
      Ocp-Apim-Subscription-Key: ${DNB_SUBSCRIPTION_KEY_DEV}
      Accept: application/json
      User-Agent: Orkhon-Toolbox-Dev/1.0
    rateLimitPerMinute: 30

tools:
  # DNB Echo API - actual spec from documentation
  dnb-echo-helloworld:
    kind: http
    source: dnb-api-dev
    method: GET
    path: /echo-api/helloworld
    description: |
      Test DNB API connectivity with the Echo API Hello World endpoint.
      Returns: {"helloWorld": "DNB API Services"}
      Use this to validate your development API key.

  dnb-statistics-query:
    kind: http
    source: dnb-api-dev
    method: GET
    path: /statistics/v2024100101/data
    description: Query DNB statistical data (banking sector, payments, balance of payments)
    parameters:
      dataset:
        type: string
        description: Dataset identifier
        required: true
      filters:
        type: string
        description: JSON filter criteria
        required: false
      limit:
        type: integer
        description: Max results (1-100)
        default: 50
      offset:
        type: integer
        description: Pagination offset
        default: 0
    queryParams:
      dataset: ${dataset}
      filters: ${filters}
      limit: ${limit}
      offset: ${offset}

  dnb-statistics-metadata:
    kind: http
    source: dnb-api-dev
    method: GET
    path: /statistics/v2024100101/metadata
    description: Retrieve metadata about available DNB statistical datasets
    parameters:
      dataset:
        type: string
        description: Optional dataset ID
        required: false
    queryParams:
      dataset: ${dataset}

  dnb-public-register-search:
    kind: http
    source: dnb-api-dev
    method: GET
    path: /public-register/v1/organizations
    description: Search DNB public register for licensed financial organizations
    parameters:
      name:
        type: string
        description: Organization name (partial match)
        required: false
      license_type:
        type: string
        description: License type (bank, crypto, investment-firm)
        required: false
      status:
        type: string
        description: License status (active, revoked, expired)
        default: "active"
      limit:
        type: integer
        description: Results per page (1-100)
        default: 20
      offset:
        type: integer
        description: Pagination offset
        default: 0
    queryParams:
      name: ${name}
      license_type: ${license_type}
      status: ${status}
      limit: ${limit}
      offset: ${offset}

  dnb-public-register-get-org:
    kind: http
    source: dnb-api-dev
    method: GET
    path: /public-register/v1/organizations/${organization_id}
    description: Get detailed information about a specific organization
    parameters:
      organization_id:
        type: string
        description: Unique organization identifier
        required: true